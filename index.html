<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tic Tac Toe</title>
    <style>
        .cell {
            width: 100px;
            height: 100px;
            border: 1px solid #000;
            display: inline-block;
            font-size: 3em;
            text-align: center;
            line-height: 100px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="board"></div>
    <div id="message"></div>
    <button id="resetButton">Reset Game</button>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const board = document.getElementById('board');
            const cells = [];
            let currentPlayer = 'X';
            let winner = null;
            let userGuessesLeft = 3;
            let userPoints = 0;
            let computerPoints = 0;

            // Create the Tic Tac Toe board
            for (let i = 0; i < 9; i++) {
                const cell = document.createElement('div');
                cell.classList.add('cell');
                cell.dataset.index = i;
                cell.addEventListener('click', () => cellClicked(i));
                board.appendChild(cell);
                cells.push(cell);
            }

            // Function to handle cell clicks
            function cellClicked(index) {
                if (cells[index].innerText === '' && !winner) {
                    cells[index].innerText = currentPlayer;
                    if (checkWinner(currentPlayer)) {
                        winner = currentPlayer;
                        document.getElementById('message').innerText = `${winner} wins!`;
                        if (winner === 'X') {
                            userPoints++;
                        } else {
                            computerPoints++;
                        }
                        updateScore();
                        setTimeout(resetGame, 1500); // Delay before resetting the game
                    } else if (isBoardFull()) {
                        document.getElementById('message').innerText = "It's a draw!";
                        setTimeout(resetGame, 1500); // Delay before resetting the game
                    } else {
                        currentPlayer = currentPlayer === 'X' ? 'O' : 'X';
                        if (currentPlayer === 'O') {
                            // Computer makes a move
                            makeComputerMove();
                        }
                    }
                }
            }

            // Function to check for a winner
            function checkWinner(player) {
                const winConditions = [
                    [0, 1, 2],
                    [3, 4, 5],
                    [6, 7, 8],
                    [0, 3, 6],
                    [1, 4, 7],
                    [2, 5, 8],
                    [0, 4, 8],
                    [2, 4, 6]
                ];
                return winConditions.some(combination => combination.every(index => cells[index].innerText === player));
            }

            // Function to check if the board is full
            function isBoardFull() {
                return cells.every(cell => cell.innerText !== '');
            }

            // Function to reset the game
            document.getElementById('resetButton').addEventListener('click', resetGame);

            function resetGame() {
                cells.forEach(cell => {
                    cell.innerText = '';
                });
                currentPlayer = 'X';
                winner = null;
                userGuessesLeft = 3;
                document.getElementById('message').innerText = '';
                updateScore();
            }

            // Function to make computer move using minimax algorithm
            function makeComputerMove() {
                const bestMove = getBestMove();
                cells[bestMove.index].innerText = 'O';
                currentPlayer = 'X';
                if (checkWinner('O')) {
                    winner = 'O';
                    document.getElementById('message').innerText = `${winner} wins!`;
                    computerPoints++;
                    updateScore();
                    setTimeout(resetGame, 1500); // Delay before resetting the game
                } else if (isBoardFull()) {
                    document.getElementById('message').innerText = "It's a draw!";
                    setTimeout(resetGame, 1500); // Delay before resetting the game
                }
            }

            // Minimax algorithm to find the best move for the computer
            function getBestMove() {
                let bestScore = -Infinity;
                let bestMove;
                for (let i = 0; i < cells.length; i++) {
                    if (cells[i].innerText === '') {
                        cells[i].innerText = 'O';
                        let score = minimax(cells, 0, false);
                        cells[i].innerText = '';
                        if (score > bestScore) {
                            bestScore = score;
                            bestMove = { index: i };
                        }
                    }
                }
                return bestMove;
            }

            function minimax(board, depth, isMaximizing) {
                if (checkWinner('O')) {
                    return 10 - depth;
                } else if (checkWinner('X')) {
                    return depth - 10;
                } else if (isBoardFull()) {
                    return 0;
                }

                if (isMaximizing) {
                    let bestScore = -Infinity;
                    for (let i = 0; i < board.length; i++) {
                        if (board[i].innerText === '') {
                            board[i].innerText = 'O';
                            let score = minimax(board, depth + 1, false);
                            board[i].innerText = '';
                            bestScore = Math.max(score, bestScore);
                        }
                    }
                    return bestScore;
                } else {
                    let bestScore = Infinity;
                    for (let i = 0; i < board.length; i++) {
                        if (board[i].innerText === '') {
                            board[i].innerText = 'X';
                            let score = minimax(board, depth + 1, true);
                            board[i].innerText = '';
                            bestScore = Math.min(score, bestScore);
                        }
                    }
                    return bestScore;
                }
            }

            // Function to update the score
            function updateScore() {
                document.getElementById('score').innerText = `User: ${userPoints} | Computer: ${computerPoints}`;
            }
        });
    </script>
</body>
</html>
